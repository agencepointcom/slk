{"version":3,"sources":["../../src/pages/place/place.module.ts","../../src/pages/place/place.ts"],"names":[],"mappings":"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","file":"1.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { PlacePage } from './place';\n\n@NgModule({\n  declarations: [\n    PlacePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(PlacePage),\n  ],\n})\nexport class PlacePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/place/place.module.ts","import { Component } from '@angular/core';\nimport {AlertController, IonicPage, LoadingController, NavController, NavParams, ViewController} from 'ionic-angular';\nimport {AuthenticationService} from \"../../services/authentication.service\";\nimport {WordpressService} from \"../../services/wordpress.service\";\nimport {LaunchNavigator} from \"@ionic-native/launch-navigator\";\nimport {Geolocation} from \"@ionic-native/geolocation\";\n\n/**\n * Generated class for the PlacePage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-place',\n  templateUrl: 'place.html',\n})\nexport class PlacePage {\n\n  place: any;\n  user: any;\n  voteInProgress: boolean = false;\n  loggedUser: boolean = false;\n  isEngaged: boolean = false;\n\n  constructor(\n      public navCtrl: NavController,\n      public navParams: NavParams,\n      public loadingCtrl: LoadingController,\n      public viewCtrl: ViewController,\n      public authenticationService: AuthenticationService,\n      public wordpressService: WordpressService,\n      public alertCtrl: AlertController,\n      private launchNavigator: LaunchNavigator,\n      public geolocation: Geolocation,\n  ) {\n      this.place = this.navParams.get('place');\n\n      this.authenticationService.getUser()\n          .then(\n              (data) => {\n                  //this.user\n\n                  //console.log('USER');\n                  //console.log(JSON.stringify(data));\n                  this.loggedUser = true;\n\n                  this.wordpressService.getSuscribeEndingDate(data.nicename).subscribe(response => {\n                      console.log(JSON.stringify(response));\n                      if (response.end_date !== false) {\n                          this.isEngaged = true;\n                      }\n                  });\n              },\n              (error) => {\n                  this.loggedUser = false;\n                  console.log(this.loggedUser)\n              }\n          );\n  }\n\n  closePlace() {\n    this.viewCtrl.dismiss();\n  }\n\n  iWasHere() {\n      if( this.voteInProgress ) {\n          return false;\n      }\n\n      let loading = this.loadingCtrl.create({\n          content: ''\n      });\n\n      loading.present();\n\n      this.voteInProgress = true;\n      this.authenticationService.getUser()\n          .then(user => {\n\n              this.wordpressService.iWasHere(this.place.id, user.nicename).subscribe((response) => {\n                  console.log(response);\n                  if( response.status ) {\n                      this.place.martygeocoderlatlng.simplefavorites_count = parseInt(this.place.martygeocoderlatlng.simplefavorites_count) + 1;\n                  } else {\n                      this.place.martygeocoderlatlng.simplefavorites_count = parseInt(this.place.martygeocoderlatlng.simplefavorites_count) - 1;\n                  }\n                  this.voteInProgress = false;\n                  loading.dismiss();\n              }, error => {\n                  console.log(error);\n                  console.log(JSON.stringify(error));\n                  loading.dismiss();\n              });\n          }, error => {\n              this.voteInProgress = false;\n              loading.dismiss();\n              this.error('Vous devez être connecté pour participer aux votes');\n          });\n  }\n\n  goPlace() {\n      var itemstring = this.place.martygeocoderlatlng.martygeocoderlatlng.toString();\n\n      itemstring = itemstring.replace(\")\", \"\"); //\"{42.827682, 2.225718899999947\"\n      itemstring = itemstring.replace(\"(\", \"\"); //\"42.827682, 2.225718899999947\"\n      let splited = itemstring.split(\",\"); // [ 42.827682, 2.225718899999947 ]\n      let coords = {\n          lat: parseFloat(splited[0]),\n          lng: parseFloat(splited[1])\n      };\n\n      this.geolocation.getCurrentPosition().then(response => {\n          this.launchNavigator.navigate([coords.lat, coords.lng], {\n              start: response.coords.latitude + ', ' + response.coords.longitude,\n              appSelection: {\n                  dialogHeaderText: \"Sélectionnez une application pour l'itinéraire\",\n                  cancelButtonText: \"Cancel\",\n                  rememberChoice: {\n                      prompt: {\n                          headerText: \"Se souvenir de mon choix ?\",\n                          bodyText: \"Utiliser la même application la prochaine fois ?\",\n                          yesButtonText: \"Oui\",\n                          noButtonText: \"Non\"\n                      }\n                  }\n              }\n          });\n      });\n  }\n\n  error(message) {\n      let alert = this.alertCtrl.create({\n          message: message,\n          buttons: [\n              {\n                  text: 'OK',\n                  handler: () => {}\n              }\n          ]\n      });\n      alert.present();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/place/place.ts"],"sourceRoot":""}